{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import{useParams}from\"react-router-dom\";import AddComment from\"./AddComment\";import{retrieve}from\"../Encryption\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const SingleBlogPage=_ref=>{let{handleComment}=_ref;const{id}=useParams();const[blogPost,setBlogPost]=useState(null);const[myComment,setMyComment]=useState(null);const[comments,setComments]=useState([]);const[isOpen,setIsOpen]=useState({id:null,open:false});useEffect(()=>{handleFetchBlogs();},[]);const handleFetchBlogs=()=>{fetch(\"/blogs/\".concat(id)).then(resp=>resp.json()).then(blog=>{console.log(\"BLOGCOM: \",blog.comments);setBlogPost(blog);setComments(blog.comments);}).catch(error=>{console.log(\"error fetching blog post\",error);});};const handleUpdateComment=commentId=>{fetch(\"/comments/\".concat(commentId),{method:\"PATCH\",headers:{\"Content-Type\":\"application/json\",Authorization:\"Bearer \".concat(retrieve().access_token)},body:JSON.stringify({content:myComment})}).then(res=>res.json()).then(data=>{console.log(\"DATTA: \",data);setIsOpen({id:commentId,open:false});handleFetchBlogs();console.log(data);}).catch(err=>{throw new Error(err);});};const addComment=values=>{fetch(\"/comments\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:\"Bearer \"+retrieve().access_token},body:JSON.stringify(values)}).then(response=>{if(!response.ok){throw new Error(\"Failed to submit comment\");}return response.json();}).then(data=>{console.log(\"Comment submitted successfully:\",data);handleFetchBlogs();}).catch(error=>{console.error(\"Error submitting comment:\",error);});};const deleteComment=commentId=>{fetch(\"/comments/\".concat(commentId),{method:\"DELETE\",headers:{Authorization:\"Bearer \".concat(retrieve().access_token)}}).then(res=>{console.log(\"RES: \",res);handleFetchBlogs();}).catch(err=>{console.log(err);throw new Error(err);});};if(!blogPost){return/*#__PURE__*/_jsx(\"p\",{children:\"Loading...\"});}return/*#__PURE__*/_jsx(\"div\",{className:\"ui grid\",children:/*#__PURE__*/_jsx(\"div\",{className:\"ui centered card\",style:{width:'900px',marginTop:'20px'},children:/*#__PURE__*/_jsxs(\"div\",{className:\"ui content\",children:[/*#__PURE__*/_jsx(\"h2\",{children:blogPost.title}),/*#__PURE__*/_jsx(\"div\",{className:\"image-container\",children:blogPost.images.map((image,index)=>/*#__PURE__*/_jsx(\"img\",{className:\"ui medium centered image\",src:image.file_path,alt:\"\".concat(index+1)},index))}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"p\",{children:blogPost.content})}),/*#__PURE__*/_jsxs(\"div\",{className:\"ui centered card\",style:{width:'500px',marginTop:\"30px\"},children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Comments\"}),blogPost.comments.length>=1&&retrieve()?blogPost.comments.map((comment,index)=>/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'20px'},children:[\"Guest Name:\",comment.guest_name,\":\",/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",alignItems:\"center\",gap:\"5px\",justifyContent:\"center\"},children:[/*#__PURE__*/_jsx(\"p\",{children:comment.content}),comment.user_id===retrieve().user_id?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{className:\"mini ui teal button\",style:{marginBottom:'20px',marginTop:'20px'},onClick:()=>setIsOpen(val=>{if(!val.open){setMyComment(comment.content);return{...val,id:comment.id,open:!val.open};}}),children:\"Update\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>deleteComment(comment.id),className:\"mini ui teal button\",style:{marginBottom:'20px',marginTop:'20px'},children:\"Delete\"})]}):\"\",isOpen.id===comment.id&&isOpen.open?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",{id:\"newComment\",name:\"newComment\",value:myComment,onChange:e=>setMyComment(e.target.value)}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleUpdateComment(comment.id),children:\"Save\"})]}):\"\"]})]},index)):/*#__PURE__*/_jsx(\"p\",{children:\"No Post Comments\"})]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(AddComment,{handleComment:handleComment,blogPost:blogPost,addComment:addComment})})]})})});};export default SingleBlogPage;","map":{"version":3,"names":["React","useEffect","useState","useParams","AddComment","retrieve","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","SingleBlogPage","_ref","handleComment","id","blogPost","setBlogPost","myComment","setMyComment","comments","setComments","isOpen","setIsOpen","open","handleFetchBlogs","fetch","concat","then","resp","json","blog","console","log","catch","error","handleUpdateComment","commentId","method","headers","Authorization","access_token","body","JSON","stringify","content","res","data","err","Error","addComment","values","response","ok","deleteComment","children","className","style","width","marginTop","title","images","map","image","index","src","file_path","alt","length","comment","marginBottom","guest_name","display","alignItems","gap","justifyContent","user_id","onClick","val","name","value","onChange","e","target"],"sources":["/home/angela/Development/code/flask/blog_app_project/client/src/components/SingleBlogPage.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport AddComment from \"./AddComment\";\nimport { retrieve } from \"../Encryption\";\n\nconst SingleBlogPage = ({ handleComment }) => {\n  const { id } = useParams();\n  const [blogPost, setBlogPost] = useState(null);\n  const [myComment, setMyComment] = useState(null);\n  const [comments, setComments] = useState([]);\n  const [isOpen, setIsOpen] = useState({ id: null, open: false });\n\n  useEffect(() => {\n    handleFetchBlogs();\n  }, []);\n\n  const handleFetchBlogs = () => {\n    fetch(`/blogs/${id}`)\n      .then((resp) => resp.json())\n      .then((blog) => {\n        console.log(\"BLOGCOM: \", blog.comments);\n        setBlogPost(blog);\n        setComments(blog.comments);\n      })\n      .catch((error) => {\n        console.log(\"error fetching blog post\", error);\n      });\n  };\n\n  const handleUpdateComment = (commentId) => {\n    fetch(`/comments/${commentId}`, {\n      method: \"PATCH\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${retrieve().access_token}`,\n      },\n      body: JSON.stringify({ content: myComment }),\n    })\n      .then((res) => res.json())\n      .then((data) => {\n        console.log(\"DATTA: \", data);\n        setIsOpen({ id: commentId, open: false });\n        handleFetchBlogs();\n        console.log(data);\n      })\n      .catch((err) => {\n        throw new Error(err);\n      });\n  };\n\n  const addComment = (values) => {\n    fetch(\"/comments\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + retrieve().access_token,\n      },\n      body: JSON.stringify(values),\n    })\n      .then((response) => {\n        if (!response.ok) {\n          throw new Error(\"Failed to submit comment\");\n        }\n        return response.json();\n      })\n      .then((data) => {\n        console.log(\"Comment submitted successfully:\", data);\n        handleFetchBlogs();\n      })\n      .catch((error) => {\n        console.error(\"Error submitting comment:\", error);\n      });\n  };\n\n  const deleteComment = (commentId) => {\n    fetch(`/comments/${commentId}`, {\n      method: \"DELETE\",\n      headers: {\n        Authorization: `Bearer ${retrieve().access_token}`,\n      },\n    })\n      .then((res) => {\n        console.log(\"RES: \", res);\n        handleFetchBlogs();\n      })\n      .catch((err) => {\n        console.log(err);\n        throw new Error(err);\n      });\n  };\n\n  if (!blogPost) {\n    return <p>Loading...</p>;\n  }\n\n  return (\n    <div className=\"ui grid\">\n      <div className=\"ui centered card\" style={{ width: '900px',marginTop:'20px' }}>\n      <div className=\"ui content\">\n      <h2>{blogPost.title}</h2>\n\n      <div className=\"image-container\">\n        {blogPost.images.map((image, index) => (\n          <img\n            key={index}\n            className=\"ui medium centered image\"\n            src={image.file_path}\n            alt={`${index + 1}`}\n          />\n        ))}\n      </div>\n\n      <div>\n        <p>{blogPost.content}</p>\n      </div>\n\n      <div className=\"ui centered card\"style={{ width: '500px', marginTop:\"30px\" }}>\n        <h2>Comments</h2>\n        {blogPost.comments.length >= 1 && retrieve() ? (\n          blogPost.comments.map((comment, index) => (\n            <div key={index} style={{ marginBottom:'20px'}}>\n              Guest Name:{comment.guest_name}:\n              \n              <div \n                style={{\n                  display: \"flex\",\n                  alignItems: \"center\",\n                  gap: \"5px\",\n                  justifyContent: \"center\",\n                }}\n              >\n                <p>{comment.content}</p>\n                {comment.user_id === retrieve().user_id ? (\n                  <>\n                    <button\n                     className=\"mini ui teal button\"\n                     style={{ marginBottom:'20px', marginTop:'20px'}}\n                      onClick={() =>\n                        setIsOpen((val) => {\n                          if (!val.open) {\n                            setMyComment(comment.content);\n                            return { ...val, id: comment.id, open: !val.open };\n                          }\n                        })\n                      }\n                    >\n                      Update\n                    </button>\n                    <button onClick={() => deleteComment(comment.id)} className=\"mini ui teal button\" style={{ marginBottom:'20px', marginTop:'20px'}}>\n                      Delete\n                    </button>\n                  </>\n                ) : (\n                  \"\"\n                )}\n                {isOpen.id === comment.id && isOpen.open ? (\n                  <div>\n                    <input\n                      id=\"newComment\"\n                      name=\"newComment\"\n                      value={myComment}\n                      onChange={(e) => setMyComment(e.target.value)}\n                    />\n                    <button onClick={() => handleUpdateComment(comment.id)}>\n                      Save\n                    </button>\n                  </div>\n                ) : (\n                  \"\"\n                )}\n              </div>\n            </div>\n          ))\n        ) : (\n          <p>No Post Comments</p>\n        )}\n     \n\n      \n      </div>\n      <div>\n        <AddComment\n          handleComment={handleComment}\n          blogPost={blogPost}\n          addComment={addComment}\n        />\n      </div>\n      </div>\n    </div>\n    </div>\n  );\n};\n\nexport default SingleBlogPage;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}