{"ast":null,"code":"import React from\"react\";import{useState,useEffect}from\"react\";import{useNavigate,useParams}from\"react-router-dom\";import{retrieve}from\"../Encryption\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const UpdatePost=()=>{const navigate=useNavigate();const[selectedCategory,setSelectedCategory]=useState(null);const[categories,setCategories]=useState(null);const[fileUpload,setFileUpload]=useState(null);const[image,setImage]=useState(null);const{id}=useParams();const user=retrieve();const[updatedPost,setUpdatedPost]=useState({title:\"\",excerpt:\"\",content:\"\",category:selectedCategory});useEffect(()=>{fetch(\"/blogs/\".concat(id)).then(resp=>resp.json()).then(blog=>{console.log(blog);setUpdatedPost({title:blog.title,excerpt:blog.excerpt,content:blog.content// category:blog.categories\n});categoryData();}).catch(error=>{console.log(\"error fetching data\",error);});},[]);const handleEditClick=()=>{fetch(\"/blogs/\".concat(id),{method:\"PATCH\",headers:{\"Content-Type\":\"application/json\",\"Authorization\":\"Bearer \"+retrieve().access_token},body:JSON.stringify(updatedPost)}).then(resp=>resp.json()).then(data=>{console.log(data);if(fileUpload){const blogId=data.id;const formData=new FormData();formData.append(\"file\",fileUpload);formData.append(\"description\",\"\");fetch(\"/upload/\".concat(blogId),{method:\"POST\",headers:{\"Authorization\":\"Bearer \"+retrieve().access_token},body:formData}).then(res=>res.json()).then(data=>{console.log(data);navigate(\"/profile_page\");});}navigate(\"/profile_page\");}).catch(error=>{console.error(\"Error updating post:\",error);});};function categoryData(){fetch(\"/categories\").then(resp=>resp.json()).then(data=>setCategories(data));}const handleChange=e=>{const file=e.target.files[0];setFileUpload(file);const reader=new FileReader();reader.readAsDataURL(file);reader.onloadend=()=>{setImage(reader.result);console.log(image);};};return/*#__PURE__*/_jsx(\"div\",{className:\"page-container\",style:{display:'flex',justifyContent:'center',alignItems:'center',marginTop:\"50px\"},children:/*#__PURE__*/_jsxs(\"div\",{className:\"ui card form-container\",style:{width:'350px'},children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Update Post\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-details-container\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Blog Title\"}),/*#__PURE__*/_jsx(\"textarea\",{id:\"title\",name:\"title\",rows:\"10\",cols:\"30\",value:updatedPost.title,onChange:e=>setUpdatedPost({...updatedPost,title:e.target.value})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-details-container\",children:[/*#__PURE__*/_jsx(\"label\",{children:\" Blog Excerpt\"}),/*#__PURE__*/_jsx(\"textarea\",{id:\"excerpt\",name:\"excerpt\",rows:\"10\",cols:\"30\",value:updatedPost.excerpt,onChange:e=>setUpdatedPost({...updatedPost,excerpt:e.target.value})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-details-container\",children:[/*#__PURE__*/_jsx(\"label\",{children:\" Blog Content\"}),/*#__PURE__*/_jsx(\"textarea\",{id:\"content\",name:\"content\",rows:\"10\",cols:\"30\",value:updatedPost.content,onChange:e=>setUpdatedPost({...updatedPost,content:e.target.value})})]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleEditClick(),className:\"mini ui teal button\",children:\"Save\"})})]})]})});};export default UpdatePost;","map":{"version":3,"names":["React","useState","useEffect","useNavigate","useParams","retrieve","jsx","_jsx","jsxs","_jsxs","UpdatePost","navigate","selectedCategory","setSelectedCategory","categories","setCategories","fileUpload","setFileUpload","image","setImage","id","user","updatedPost","setUpdatedPost","title","excerpt","content","category","fetch","concat","then","resp","json","blog","console","log","categoryData","catch","error","handleEditClick","method","headers","access_token","body","JSON","stringify","data","blogId","formData","FormData","append","res","handleChange","e","file","target","files","reader","FileReader","readAsDataURL","onloadend","result","className","style","display","justifyContent","alignItems","marginTop","children","width","name","rows","cols","value","onChange","onClick"],"sources":["/home/angela/Development/code/flask/blog_app_project/client/src/components/UpdatePost.js"],"sourcesContent":["import React from \"react\";\nimport { useState, useEffect } from \"react\";\nimport { useNavigate, useParams } from \"react-router-dom\";\nimport { retrieve } from \"../Encryption\";\n\n\nconst UpdatePost = () => {\n  const navigate = useNavigate();\n  const [selectedCategory, setSelectedCategory] = useState(null);\n  const[ categories,setCategories]=useState(null)\n  const [fileUpload, setFileUpload] = useState(null);\n  const [image, setImage] = useState(null);\n  const {id}=useParams()\n  const user = retrieve()\n  const [updatedPost, setUpdatedPost] = useState({\n    title: \"\",\n    excerpt: \"\",\n    content: \"\",\n    category:selectedCategory\n   \n  });\n\n  useEffect(()=>{\n    fetch(`/blogs/${id}`)\n      .then((resp) => resp.json())\n      .then((blog) => {\n       console.log(blog)\n        setUpdatedPost({\n            title:blog.title,\n            excerpt:blog.excerpt,\n            content:blog.content,\n            // category:blog.categories\n        })\n      categoryData()\n      })\n      .catch((error) => {\n        console.log(\"error fetching data\", error);\n      });\n  },[])\n\n  const handleEditClick = () => {\n    fetch(`/blogs/${id}`, {\n      method: \"PATCH\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"Authorization\":\"Bearer \"+ retrieve().access_token\n      },\n      body: JSON.stringify(updatedPost),\n    })\n      .then((resp) => resp.json())\n      .then((data) => {\n        console.log(data)\n       if (fileUpload){       \n        const blogId=data.id\n        const formData = new FormData();\n        formData.append(\"file\", fileUpload);\n        formData.append(\"description\", \"\");\n      \n        fetch(`/upload/${blogId}`, {\n          method: \"POST\",\n          headers:{\"Authorization\": \"Bearer \" + retrieve().access_token},\n          body: formData,\n        })\n          .then((res) => res.json())\n          .then((data) => {\n            console.log(data);\n            navigate(\"/profile_page\")\n          });\n       }\n       navigate(\"/profile_page\")\n\n      })\n      .catch((error) => {\n        console.error(\"Error updating post:\", error);\n      });\n  };\n  function categoryData() {\n    fetch(\"/categories\") \n      .then((resp) => resp.json())\n      .then((data) => setCategories(data));\n  }\n  const handleChange = (e) => {\n    const file = e.target.files[0];\n    setFileUpload(file);\n    const reader = new FileReader();\n    reader.readAsDataURL(file);\n\n    reader.onloadend = () => {\n      setImage(reader.result);\n      console.log(image);\n    };\n  };\n \n  \n\n  return (\n    <div className=\"page-container\" style={{ display: 'flex', justifyContent: 'center', alignItems: 'center', marginTop:\"50px\" }}>\n      \n      <div className=\"ui card form-container\" style={{ width: '350px' }}>\n      <h2>Update Post</h2>\n        <div className=\"content\">\n          <div className=\"form-details-container\">\n            <label>Blog Title</label>\n            <textarea\n              id=\"title\"\n              name=\"title\"\n              rows=\"10\"\n              cols=\"30\"\n              value={updatedPost.title}\n              onChange={(e) => setUpdatedPost({ ...updatedPost, title: e.target.value })}\n            ></textarea>\n          </div>\n          <div className=\"form-details-container\">\n            <label> Blog Excerpt</label>\n            <textarea\n              id=\"excerpt\"\n              name=\"excerpt\"\n              rows=\"10\"\n              cols=\"30\"\n              value={updatedPost.excerpt}\n              onChange={(e) => setUpdatedPost({ ...updatedPost, excerpt: e.target.value })}\n            ></textarea>\n          </div>\n          <div className=\"form-details-container\">\n            <label> Blog Content</label>\n            <textarea\n              id=\"content\"\n              name=\"content\"\n              rows=\"10\"\n              cols=\"30\"\n              value={updatedPost.content}\n              onChange={(e) => setUpdatedPost({ ...updatedPost, content: e.target.value })}\n            ></textarea>\n          </div>\n          {/* <div>\n            <br />\n            <label htmlFor=\"fileInput\">Upload Photo Here</label>\n            <input\n              type=\"file\"\n              id=\"file\"\n              onChange={(e) => handleChange(e)}\n              required\n              accept=\"image/png,image/jpeg,image/jpg,image/jfif\"\n            />\n            <img src={image} alt=\"\" />\n           \n          </div> */}\n          <div><button onClick={() => handleEditClick()} className=\"mini ui teal button\">Save</button></div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default UpdatePost;\n\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}